# Informe Pentesting

# Parte 1 - SQLi
## a) SQLi error inicio de sesión

## b) Ataque de diccionario para impersonar usuarios

## c) Vulnerabilidad en SQLite3::escapeString() y solución

## d) Publicar comentarios en nombre de otros usuarios mediante vulnerabilidades


<br>

---

# Parte 2 - XSS

## a) Crear un comentario con un alert de JavaScript

## b) Explicación del uso de & en lugar de & en enlaces GET

## c) Vulnerabilidad en show_comments.php y corrección

## d) Identificar otras páginas afectadas por XSS y análisis


<br>

---

# Parte 3 - Control de acceso, autenticación y sesiones de usuarios

## a) Medidas de seguridad para evitar un registro inseguro

## b) Medidas de seguridad para asegurar el login

## c) Restricciones para el acceso a register.php

## d) Configuración de la carpeta private para evitar acceso no autorizado

## e) Análisis y aseguramiento del flujo de sesiones de usuarios


<br>

---

# Parte 4 - Servidores web
## Punto 1: Configuración del Servidor Web
Para minimizar el riesgo de ataques en el servidor web, es posible implementar medidas que abarcan tanto la configuración del sistema operativo, como políticas organizativas y ajustes técnicos más específicos.

## Punto 1: Configuración del Servidor Web
Es esencial deshabilitar módulos o servicios que no sean necesarios, disminuyendo así la superficie de ataque. Además, se debe ocultar información sensible del servidor configurando opciones como ServerTokens a Prod y ServerSignature a Off.

---
## Punto 2: Seguridad de las Conexiones
Es fundamental habilitar HTTPS para garantizar que todas las comunicaciones estén encriptadas mediante certificados SSL/TLS. Además, se debe implementar HTTP Strict Transport Security (HSTS) para obligar a los navegadores a realizar únicamente conexiones seguras.

---
## Punto 3: Control de Acceso
Se debe implementar autenticación de dos factores (2FA), añadiendo una capa adicional de protección para los usuarios. Además, la instalación de un cortafuegos de aplicaciones web (WAF) ayudaría a bloquear automáticamente patrones de tráfico malintencionado.

---
## Punto 4: Cabeceras HTTP de Seguridad
La configuración de cabeceras HTTP protege las aplicaciones web frente a amenazas comunes. La cabecera Content-Security-Policy limita los orígenes de scripts y recursos para prevenir ataques de XSS. Otras cabeceras esenciales incluyen X-Frame-Options para evitar ataques de clickjacking, X-Content-Type-Options para evitar la interpretación incorrecta de tipos MIME, y Referrer-Policy para controlar la información de referencia que se envía a otros sitios.

---
## Punto 5: Protección contra Ataques Comunes
Para mitigar ataques de fuerza bruta, es importante limitar el número de intentos de inicio de sesión. La protección contra inyección SQL se logra utilizando consultas preparadas en lugar de concatenar cadenas SQL. Para prevenir ataques XSS, se deben escapar adecuadamente los datos de entrada y salida.

---
## Punto 6: Registro y Monitorización
Habilitar logs detallados de errores y accesos es crucial para detectar actividades sospechosas. Estos registros deben ser supervisados constantemente mediante herramientas de monitoreo y alertas que permitan una respuesta rápida ante incidentes.

---
## Punto 7: Parcheado y Actualización
El servidor web debe mantenerse actualizado con los últimos parches de seguridad. Esto incluye además del software principal (Apache o Nginx) todas las bibliotecas y dependencias utilizadas por la aplicación web. Mantener todo actualizado reduce el riesgo de vulnerabilidades conocidas.

---
## Punto 8: Configuración de Bases de Datos
El servidor web no debe tener acceso directo con privilegios de administrador a las bases de datos. Las aplicaciones deben operar con cuentas que tengan permisos mínimos para realizar sus tareas.


<br>

---


# Parte 5 - CSRF
## a) Botón Profile con formulario malicioso en list_players.php

## b) Creación de un comentario para un ataque CSRF sin interacción del usuario

## c) Condiciones necesarias para que el ataque funcione

## d) Blindaje contra CSRF usando POST y ataque alternativo